{"ast":null,"code":"import _regeneratorRuntime from\"/home/hypescript/Projects/essaTS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/regenerator\";import _asyncToGenerator from\"/home/hypescript/Projects/essaTS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"/home/hypescript/Projects/essaTS/node_modules/babel-preset-react-app/node_modules/@babel/runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{useForm}from'react-hook-form';import Lood from'../Lood/Lood';import ValitudLugu from'../ValitudLugu/ValitudLugu';import'./Menu.scss';var playlist=require('../../songPlaylist.json');var Menu=function Menu(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeIndex=_useState2[0],setActiveIndex=_useState2[1];var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit;var _useState3=useState(),_useState4=_slicedToArray(_useState3,2),uploadedFile=_useState4[0],setUploadedFile=_useState4[1];var _useState5=useState(),_useState6=_slicedToArray(_useState5,2),editSong=_useState6[0],setEditSong=_useState6[1];var musicRef=useRef(null);useEffect(function(){if(musicRef.current)musicRef.current.src=playlist[activeIndex].heliFail;},[activeIndex]);var handleClick=function handleClick(e){var newActiveIndex=e.target.getAttribute('data-index');setActiveIndex(newActiveIndex);};var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var formData,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:formData=new FormData();formData.append('file',data.file[0]);_context.next=4;return fetch('http://localhost:5000/upload',{method:\"POST\",body:formData}).then(function(res){return res.json();});case 4:res=_context.sent;alert(JSON.stringify(res));case 6:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();var renderValitudLugu=function renderValitudLugu(){if(playlist.length){return/*#__PURE__*/React.createElement(ValitudLugu,{lugu:playlist[activeIndex]});}return null;};var renderValitudTekst=function renderValitudTekst(){if(playlist.length){return/*#__PURE__*/React.createElement(\"p\",null,\"Now playing: \".concat(playlist[activeIndex].laulja,\" - \").concat(playlist[activeIndex].looNimi));}return null;};var getFiles=/*#__PURE__*/function(){var _ref2=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee2(){return _regeneratorRuntime.wrap(function _callee2$(_context2){while(1){switch(_context2.prev=_context2.next){case 0:_context2.next=2;return fetch('http://localhost:5000/songs').then(function(res){return res.json();}).then(function(files){return setUploadedFile(files);});case 2:case\"end\":return _context2.stop();}}},_callee2);}));return function getFiles(){return _ref2.apply(this,arguments);};}();var splitAudio=/*#__PURE__*/function(){var _ref3=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee3(filename){var data,res;return _regeneratorRuntime.wrap(function _callee3$(_context3){while(1){switch(_context3.prev=_context3.next){case 0:filename=editSong;data=new FormData();data.append('filename',filename.file[0]);res=fetch('http://localhost:5000/split/'+filename+'/split',{method:\"POST\",body:data}).then(function(res){return res.json();});alert(JSON.stringify(res));case 5:case\"end\":return _context3.stop();}}},_callee3);}));return function splitAudio(_x2){return _ref3.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"menu\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container1\"},renderValitudLugu(),/*#__PURE__*/React.createElement(\"p\",{style:{paddingTop:'350px'}},renderValitudTekst()),/*#__PURE__*/React.createElement(\"audio\",{ref:musicRef,autoPlay:true,controls:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"container2\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Pick a song!\"),/*#__PURE__*/React.createElement(Lood,{playlist:playlist,handleClick:handleClick})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"input\",{ref:register,type:\"file\",name:\"file\",accept:\"audio/mpeg\"}),/*#__PURE__*/React.createElement(\"button\",null,\"Submit\"))),console.log(uploadedFile),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"button\",{onClick:getFiles},\"Show uploaded songs\"),uploadedFile?/*#__PURE__*/React.createElement(\"div\",null,uploadedFile.files.map(function(array){return array.map(function(file,index){return/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,file),/*#__PURE__*/React.createElement(\"audio\",{src:'/'+file,controls:true}),setEditSong(file),/*#__PURE__*/React.createElement(\"button\",{onClick:splitAudio},\"Split audio\"));});})):null));};export default Menu;","map":{"version":3,"sources":["/home/hypescript/Projects/essaTS/src/components/Menu/Menu.tsx"],"names":["React","useState","useEffect","useRef","useForm","Lood","ValitudLugu","playlist","require","Menu","activeIndex","setActiveIndex","register","handleSubmit","uploadedFile","setUploadedFile","editSong","setEditSong","musicRef","current","src","heliFail","handleClick","e","newActiveIndex","target","getAttribute","onSubmit","data","formData","FormData","append","file","fetch","method","body","then","res","json","alert","JSON","stringify","renderValitudLugu","length","renderValitudTekst","laulja","looNimi","getFiles","files","splitAudio","filename","paddingTop","console","log","map","array","index"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, FC } from 'react';\nimport { useForm } from 'react-hook-form';\nimport Lood from '../Lood/Lood';\nimport ValitudLugu from '../ValitudLugu/ValitudLugu';\n\nimport './Menu.scss';\n\nconst playlist = require('../../songPlaylist.json');\n\n\nconst Menu: FC = () => {\n    \n    const [activeIndex, setActiveIndex] = useState<number>(0);\n    const { register, handleSubmit } = useForm<any>();\n    const [uploadedFile, setUploadedFile] = useState<any>();\n    const [editSong, setEditSong] = useState<any>();\n\n    const musicRef = useRef<HTMLAudioElement>(null);\n\n    useEffect(() => {\n        if(musicRef.current)\n            musicRef.current.src = playlist[activeIndex].heliFail\n    }, [activeIndex]);\n\n    const handleClick = (e:any) => {\n        const newActiveIndex = e.target.getAttribute('data-index')\n        setActiveIndex( newActiveIndex )\n    };\n\n    const onSubmit = async (data:any) => {\n        const formData = new FormData();\n        formData.append('file', data.file[0]);\n\n        const res = await fetch('http://localhost:5000/upload', {\n            method: \"POST\",\n            body: formData\n        }).then(res => res.json())\n        alert(JSON.stringify(res))\n    };\n\n    const renderValitudLugu = () => {\n        if(playlist.length) {\n            return (\n                <ValitudLugu lugu={playlist[activeIndex]}/>\n            )\n        }\n        return null\n    };\n\n    const renderValitudTekst = () => {\n        if(playlist.length) {\n            return (\n                    <p>{(`Now playing: ${playlist[activeIndex].laulja} - ${playlist[activeIndex].looNimi}`)}</p>\n            )\n        }\n        return null\n    };\n       \n    const getFiles = async () => {\n        await fetch('http://localhost:5000/songs')\n            .then(res => res.json())\n            .then(files => setUploadedFile(files))\n    };\n\n     const splitAudio = async (filename:any) => {\n         filename = editSong;\n         const data = new FormData();\n         data.append('filename', filename.file[0]);\n\n         const res = fetch('http://localhost:5000/split/'+filename+'/split', {\n             method: \"POST\",\n             body: data\n         }).then(res => res.json())\n         alert(JSON.stringify(res));\n    }; \n\n\n    return(\n        <div className=\"menu\">\n            {/* valitud loo preview */}\n            <div className=\"container1\">\n                {renderValitudLugu()}\n                <p style={{paddingTop: '350px'}}>{renderValitudTekst()}</p>\n                <audio ref={musicRef} autoPlay controls />\n            </div>\n            {/* lugude list */}\n            <div className=\"container2\">\n                <h1>Pick a song!</h1>\n                <Lood playlist={playlist} handleClick={handleClick}/>\n            </div>\n            {/* lugude uploadi form */}\n            <div>\n                <form onSubmit={handleSubmit(onSubmit)}>\n                    <input ref={register} type=\"file\" name=\"file\" accept=\"audio/mpeg\" />\n                    <button>Submit</button>\n                </form>\n            </div>\n\n            {/* uploaditud lugude sektsioon */}\n \n            {console.log(uploadedFile)}\n            <div>\n                <button onClick={getFiles}>Show uploaded songs</button>\n                {uploadedFile ? (\n                <div>\n                    {uploadedFile.files.map((array:any) => array.map((file:any, index:number) => \n                        <div>\n                            <h1>{file}</h1>\n                            <audio src={'/' + file} controls />\n                            {setEditSong(file)}\n                            <button onClick={splitAudio}>Split audio</button> \n                        </div>\n                    ))}\n                </div>\n                ) : null}\n            </div>\n        </div>\n    )\n}\n\nexport default Menu;\n"]},"metadata":{},"sourceType":"module"}