{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Admin\\\\muss\\\\muss\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Admin\\\\muss\\\\muss\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Admin\\\\muss\\\\muss\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import Lood from'../Lood/Lood';import ValitudLugu from'../ValitudLugu/ValitudLugu';import axios from'axios';import'./Menu.scss';var playlist=require('../../songPlaylist.json');var Menu=function Menu(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeIndex=_useState2[0],setActiveIndex=_useState2[1];var _useState3=useState(''),_useState4=_slicedToArray(_useState3,2),file=_useState4[0],setFile=_useState4[1];var _useState5=useState('Choose song'),_useState6=_slicedToArray(_useState5,2),fileName=_useState6[0],setFileName=_useState6[1];var _useState7=useState({}),_useState8=_slicedToArray(_useState7,2),uploadedFile=_useState8[0],setUploadedFile=_useState8[1];var handleClick=function handleClick(e){var newActiveIndex=e.target.getAttribute('data-index');setActiveIndex(newActiveIndex);};var renderValitudLugu=function renderValitudLugu(){if(playlist.length){return/*#__PURE__*/React.createElement(ValitudLugu,{lugu:playlist[activeIndex]});}return null;};var renderValitudTekst=function renderValitudTekst(){if(playlist.length){return/*#__PURE__*/React.createElement(\"p\",null,\"Now playing: \".concat(playlist[activeIndex].laulja,\" - \").concat(playlist[activeIndex].looNimi));}return null;};var musicRef=useRef(null);useEffect(function(){if(musicRef.current)musicRef.current.src=playlist[activeIndex].heliFail;},[activeIndex]);//FAILI UPLOADIMINE\nvar chooseFile=function chooseFile(e){setFile(e.target.files[0]);setFileName(e.target.files[0].name);};var submitFile=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(e){var formData,res,_res$data,_fileName,filePath;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:e.preventDefault();formData=new FormData();formData.append('file',file);_context.prev=3;_context.next=6;return axios.post('localhost:5000/upload',formData,{headers:{'Content-Type':'multipart/form-data'}});case 6:res=_context.sent;_res$data=res.data,_fileName=_res$data.fileName,filePath=_res$data.filePath;setUploadedFile({fileName:_fileName,filePath:filePath});_context.next=14;break;case 11:_context.prev=11;_context.t0=_context[\"catch\"](3);if(_context.t0.response.status===500){console.log('Server problem');}else{console.log(_context.t0.response.data.msg);}case 14:case\"end\":return _context.stop();}}},_callee,null,[[3,11]]);}));return function submitFile(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"menu\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container1\"},renderValitudLugu(),/*#__PURE__*/React.createElement(\"p\",{style:{paddingTop:'350px'}},renderValitudTekst()),/*#__PURE__*/React.createElement(\"audio\",{ref:musicRef,autoPlay:true,controls:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"container2\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Pick a song!\"),/*#__PURE__*/React.createElement(Lood,{playlist:playlist,handleClick:handleClick})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:submitFile},/*#__PURE__*/React.createElement(\"input\",{type:\"file\",id:\"audioFile\",onChange:chooseFile}),/*#__PURE__*/React.createElement(\"label\",{htmlFor:\"audiFile\"},fileName),/*#__PURE__*/React.createElement(\"input\",{type:\"submit\",value:\"Upload\"}))));};export default Menu;","map":{"version":3,"sources":["C:/Users/Admin/muss/muss/src/components/Menu/Menu.tsx"],"names":["React","useState","useEffect","useRef","Lood","ValitudLugu","axios","playlist","require","Menu","activeIndex","setActiveIndex","file","setFile","fileName","setFileName","uploadedFile","setUploadedFile","handleClick","e","newActiveIndex","target","getAttribute","renderValitudLugu","length","renderValitudTekst","laulja","looNimi","musicRef","current","src","heliFail","chooseFile","files","name","submitFile","preventDefault","formData","FormData","append","post","headers","res","data","filePath","response","status","console","log","msg","paddingTop"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, FC } from 'react';\r\nimport Lood from '../Lood/Lood';\r\nimport ValitudLugu from '../ValitudLugu/ValitudLugu';\r\nimport axios from 'axios';\r\nimport './Menu.scss';\r\n\r\nconst playlist = require('../../songPlaylist.json')\r\n\r\n\r\nconst Menu: FC = () => {\r\n    \r\n    const [activeIndex, setActiveIndex] = useState<number>(0);\r\n    const [file, setFile] = useState<string>('');\r\n    const [fileName, setFileName] = useState<string>('Choose song');\r\n    const [uploadedFile, setUploadedFile] = useState<any>({});\r\n\r\n    const handleClick = (e:any) => {\r\n        const newActiveIndex = e.target.getAttribute('data-index')\r\n        setActiveIndex( newActiveIndex )\r\n    };\r\n\r\n    const renderValitudLugu = () => {\r\n        if(playlist.length) {\r\n            return (\r\n                <ValitudLugu lugu={playlist[activeIndex]}/>\r\n            )\r\n        }\r\n        return null\r\n    };\r\n\r\n    const renderValitudTekst = () => {\r\n        if(playlist.length) {\r\n            return (\r\n                    <p>{(`Now playing: ${playlist[activeIndex].laulja} - ${playlist[activeIndex].looNimi}`)}</p>\r\n            )\r\n        }\r\n        return null\r\n    };\r\n    \r\n    const musicRef = useRef<HTMLAudioElement>(null);\r\n\r\n    useEffect(() => {\r\n        if(musicRef.current)\r\n            musicRef.current.src = playlist[activeIndex].heliFail\r\n    }, [activeIndex])\r\n\r\n    //FAILI UPLOADIMINE\r\n\r\n    const chooseFile = (e:any) => {\r\n        setFile(e.target.files[0]);\r\n        setFileName(e.target.files[0].name);\r\n    };\r\n\r\n    const submitFile = async (e:any) => {\r\n        e.preventDefault();\r\n        const formData = new FormData();\r\n        formData.append('file', file);\r\n\r\n        try {\r\n            const res = await axios.post('localhost:5000/upload', formData, {\r\n                headers: {\r\n                    'Content-Type': 'multipart/form-data'\r\n                }\r\n            });\r\n            const { fileName, filePath } = res.data;\r\n\r\n            setUploadedFile({ fileName, filePath });\r\n        } catch(err) {\r\n            if(err.response.status === 500) {\r\n                console.log('Server problem');\r\n            } else {\r\n                console.log(err.response.data.msg)\r\n            }\r\n        }\r\n    };\r\n\r\n\r\n    return(\r\n        <div className=\"menu\">\r\n            {/* valitud loo preview */}\r\n            <div className=\"container1\">\r\n                {renderValitudLugu()}\r\n                <p style={{paddingTop: '350px'}}>{renderValitudTekst()}</p>\r\n                <audio ref={musicRef} autoPlay controls />\r\n            </div>\r\n            {/* lugude list */}\r\n            <div className=\"container2\">\r\n                <h1>Pick a song!</h1>\r\n                <Lood playlist={playlist} handleClick={handleClick}/>\r\n            </div>\r\n            {/* lugude upload */}\r\n            <div>\r\n                <form onSubmit={submitFile}>\r\n                    <input type=\"file\" id=\"audioFile\" onChange={chooseFile} />\r\n                    <label htmlFor=\"audiFile\">{fileName}</label>\r\n                    <input type=\"submit\" value=\"Upload\" />\r\n                </form>\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Menu;\r\n"]},"metadata":{},"sourceType":"module"}