{"ast":null,"code":"import _regeneratorRuntime from\"C:\\\\Users\\\\Admin\\\\muss\\\\muss\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/regenerator\";import _asyncToGenerator from\"C:\\\\Users\\\\Admin\\\\muss\\\\muss\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/asyncToGenerator\";import _slicedToArray from\"C:\\\\Users\\\\Admin\\\\muss\\\\muss\\\\node_modules\\\\babel-preset-react-app\\\\node_modules\\\\@babel\\\\runtime/helpers/esm/slicedToArray\";import React,{useState,useEffect,useRef}from'react';import{useForm}from'react-hook-form';import Lood from'../Lood/Lood';import ValitudLugu from'../ValitudLugu/ValitudLugu';import UploadiLugu from'../UploadiLugu/UploadiLugu';import'./Menu.scss';var playlist=require('../../songPlaylist.json');var Menu=function Menu(){var _useState=useState(0),_useState2=_slicedToArray(_useState,2),activeIndex=_useState2[0],setActiveIndex=_useState2[1];var _useForm=useForm(),register=_useForm.register,handleSubmit=_useForm.handleSubmit;var _useState3=useState(null),_useState4=_slicedToArray(_useState3,2),uploadedFile=_useState4[0],setUploadedFile=_useState4[1];var handleClick=function handleClick(e){var newActiveIndex=e.target.getAttribute('data-index');setActiveIndex(newActiveIndex);};var renderValitudLugu=function renderValitudLugu(){if(playlist.length){return/*#__PURE__*/React.createElement(ValitudLugu,{lugu:playlist[activeIndex]});}return null;};var renderValitudTekst=function renderValitudTekst(){if(playlist.length){return/*#__PURE__*/React.createElement(\"p\",null,\"Now playing: \".concat(playlist[activeIndex].laulja,\" - \").concat(playlist[activeIndex].looNimi));}return null;};var musicRef=useRef(null);useEffect(function(){if(musicRef.current)musicRef.current.src=playlist[activeIndex].heliFail;},[activeIndex]);var onSubmit=/*#__PURE__*/function(){var _ref=_asyncToGenerator(/*#__PURE__*/_regeneratorRuntime.mark(function _callee(data){var formData,res;return _regeneratorRuntime.wrap(function _callee$(_context){while(1){switch(_context.prev=_context.next){case 0:formData=new FormData();formData.append('file',data.file[0]);_context.next=4;return fetch('http://localhost:5000/upload',{method:\"POST\",body:formData}).then(function(res){return res.json();});case 4:res=_context.sent;alert(JSON.stringify(res));setUploadedFile(data.file[0]);case 7:case\"end\":return _context.stop();}}},_callee);}));return function onSubmit(_x){return _ref.apply(this,arguments);};}();return/*#__PURE__*/React.createElement(\"div\",{className:\"menu\"},/*#__PURE__*/React.createElement(\"div\",{className:\"container1\"},renderValitudLugu(),/*#__PURE__*/React.createElement(\"p\",{style:{paddingTop:'350px'}},renderValitudTekst()),/*#__PURE__*/React.createElement(\"audio\",{ref:musicRef,autoPlay:true,controls:true})),/*#__PURE__*/React.createElement(\"div\",{className:\"container2\"},/*#__PURE__*/React.createElement(\"h1\",null,\"Pick a song!\"),/*#__PURE__*/React.createElement(Lood,{playlist:playlist,handleClick:handleClick})),/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"form\",{onSubmit:handleSubmit(onSubmit)},/*#__PURE__*/React.createElement(\"input\",{ref:register,type:\"file\",name:\"file\"}),/*#__PURE__*/React.createElement(\"button\",null,\"Submit\")),console.log(uploadedFile)),/*#__PURE__*/React.createElement(\"div\",null,uploadedFile?/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"div\",null,/*#__PURE__*/React.createElement(\"h1\",null,uploadedFile.name),/*#__PURE__*/React.createElement(\"audio\",{src:uploadedFile,autoPlay:true,controls:true}))):null,/*#__PURE__*/React.createElement(UploadiLugu,null)));};export default Menu;","map":{"version":3,"sources":["C:/Users/Admin/muss/muss/src/components/Menu/Menu.tsx"],"names":["React","useState","useEffect","useRef","useForm","Lood","ValitudLugu","UploadiLugu","playlist","require","Menu","activeIndex","setActiveIndex","register","handleSubmit","uploadedFile","setUploadedFile","handleClick","e","newActiveIndex","target","getAttribute","renderValitudLugu","length","renderValitudTekst","laulja","looNimi","musicRef","current","src","heliFail","onSubmit","data","formData","FormData","append","file","fetch","method","body","then","res","json","alert","JSON","stringify","paddingTop","console","log","name"],"mappings":"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","sourcesContent":["import React, { useState, useEffect, useRef, FC } from 'react';\r\nimport { useForm } from 'react-hook-form';\r\nimport Lood from '../Lood/Lood';\r\nimport ValitudLugu from '../ValitudLugu/ValitudLugu';\r\nimport UploadiLugu from '../UploadiLugu/UploadiLugu';\r\nimport './Menu.scss';\r\n\r\nconst playlist = require('../../songPlaylist.json');\r\n\r\n\r\nconst Menu: FC = () => {\r\n    \r\n    const [activeIndex, setActiveIndex] = useState<number>(0);\r\n    const { register, handleSubmit } = useForm<any>();\r\n    const [uploadedFile, setUploadedFile] = useState<any>(null);\r\n\r\n    const handleClick = (e:any) => {\r\n        const newActiveIndex = e.target.getAttribute('data-index')\r\n        setActiveIndex( newActiveIndex )\r\n    };\r\n\r\n    const renderValitudLugu = () => {\r\n        if(playlist.length) {\r\n            return (\r\n                <ValitudLugu lugu={playlist[activeIndex]}/>\r\n            )\r\n        }\r\n        return null\r\n    };\r\n\r\n    const renderValitudTekst = () => {\r\n        if(playlist.length) {\r\n            return (\r\n                    <p>{(`Now playing: ${playlist[activeIndex].laulja} - ${playlist[activeIndex].looNimi}`)}</p>\r\n            )\r\n        }\r\n        return null\r\n    };\r\n    \r\n    const musicRef = useRef<HTMLAudioElement>(null);\r\n\r\n    useEffect(() => {\r\n        if(musicRef.current)\r\n            musicRef.current.src = playlist[activeIndex].heliFail\r\n    }, [activeIndex]);\r\n\r\n    const onSubmit = async (data:any) => {\r\n        const formData = new FormData();\r\n        formData.append('file', data.file[0]);\r\n\r\n        const res = await fetch('http://localhost:5000/upload', {\r\n            method: \"POST\",\r\n            body: formData\r\n        }).then(res => res.json())\r\n        alert(JSON.stringify(res));\r\n        \r\n        setUploadedFile(data.file[0])\r\n    }\r\n\r\n\r\n    return(\r\n        <div className=\"menu\">\r\n            {/* valitud loo preview */}\r\n            <div className=\"container1\">\r\n                {renderValitudLugu()}\r\n                <p style={{paddingTop: '350px'}}>{renderValitudTekst()}</p>\r\n                <audio ref={musicRef} autoPlay controls />\r\n            </div>\r\n            {/* lugude list */}\r\n            <div className=\"container2\">\r\n                <h1>Pick a song!</h1>\r\n                <Lood playlist={playlist} handleClick={handleClick}/>\r\n            </div>\r\n            {/* lugude uploadi form */}\r\n            <div>\r\n                <form onSubmit={handleSubmit(onSubmit)}>\r\n                    <input ref={register} type=\"file\" name=\"file\" />\r\n                    <button>Submit</button>\r\n                </form>\r\n                {console.log(uploadedFile)}\r\n            </div>\r\n            {/* uploaditud lugude sektsioon */}\r\n            <div>\r\n                {uploadedFile ? (\r\n                <div>\r\n                    <div>\r\n                        <h1>{uploadedFile.name}</h1>\r\n                        <audio src={uploadedFile} autoPlay controls />\r\n                          \r\n                    </div>\r\n                </div>\r\n                ) : null} \r\n                <UploadiLugu />\r\n            </div>\r\n        </div>\r\n    )\r\n}\r\n\r\nexport default Menu;\r\n"]},"metadata":{},"sourceType":"module"}